{"version":3,"sources":["Global/Glassmorphism.jsx","Util/ImageApiHelper.js","Api/ImageApi.js","Projects/Project1/ImageCard.jsx","Pages/MainPage/ContentPage/MyGallery.jsx"],"names":["Glass","ref","id","className","style","glassColor","children","React","forwardRef","blobURL","data","contentType","blob","b64Data","sliceSize","byteCharacters","atob","byteArrays","offset","length","slice","byteNumbers","Array","i","charCodeAt","byteArray","Uint8Array","push","Blob","type","b64toBlob","Buffer","from","toString","URL","createObjectURL","imageApi","axios","create","baseURL","process","timeout","apiImage","get","responseType","apiImageSize","ImageCard","props","useState","shouldCreate","setShouldCreate","width","height","size","setSize","image","setImage","useEffect","a","res","console","log","bimage","btob","headers","src","alt","getSize","then","_","getImage","memo","MyGallery","widthRef","useRef","currentWidth","setCurrentWidth","allSize","setAllSize","allSizeRef","createRef","renderImage","setRenderImage","renderImageRef","columns","Math","max","floor","gotAll","Object","keys","imageGallery","imageColumn","columnHeight","forEach","e","imageHeight","parseInt","replace","index","getLowestIndex","addNewImageCard","renderImageGallery","galleryResize","current","getComputedStyle","padding","mWidth","reachBotton","docHeight","document","documentElement","scrollHeight","winHeight","clientHeight","window","scrollY","createdImages","availableImages","isMobile","n","getAllSize","p","images","initImages","init","addEventListener","removeEventListener"],"mappings":"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","file":"static/js/5.60e5e18e.chunk.js","sourcesContent":["import React from 'react';\r\nimport './Glassmorphism.css';\r\n\r\n\r\nfunction Glass({ id, className, style, glassColor, children }, ref) {\r\n\r\n    if (glassColor == null)\r\n        glassColor = \"pink\";\r\n\r\n    return (\r\n        <div\r\n            id={id ? id : null}\r\n            className={`${className ? className : ''} glass_${glassColor}`}\r\n            style={{ style }}\r\n            ref={ref}\r\n        >\r\n            {children}\r\n        </div>);\r\n}\r\n\r\nexport default React.forwardRef(Glass);\r\n","const b64toBlob = (b64Data, contentType = '', sliceSize = 512) => {\r\n    const byteCharacters = atob(b64Data);\r\n    const byteArrays = [];\r\n\r\n    for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        const slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        const byteNumbers = new Array(slice.length);\r\n        for (let i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        const byteArray = new Uint8Array(byteNumbers);\r\n        byteArrays.push(byteArray);\r\n    }\r\n    const blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n}\r\n\r\nfunction blobURL(data, contentType) {\r\n    let base64 = Buffer.from(data, 'binary').toString('base64');\r\n    let blob = b64toBlob(base64, contentType);\r\n    return URL.createObjectURL(blob);\r\n}\r\n\r\nexport { blobURL };","import axios from \"axios\";\r\n\r\nconst imageApi = axios.create({\r\n    baseURL: process.env.REACT_APP_REST_IP || 'http://localhost:5000',\r\n    timeout: 20000\r\n})\r\n\r\nexport const apiImage = id => imageApi.get(`api/image/${id}`, {\r\n    responseType: 'arraybuffer'\r\n});\r\n\r\nexport const apiImageSize = (id = '') => imageApi.get(`api/imageSize/${id}`)","import React, { useEffect, useState } from 'react'\r\nimport { apiImage, apiImageSize } from '../../Api/ImageApi';\r\nimport { blobURL as btob } from '../../Util/ImageApiHelper';\r\nimport './ImageCard.css';\r\n\r\nfunction ImageCard(props) {\r\n    const [shouldCreate, setShouldCreate] = useState(true)\r\n    const [size, setSize] = useState({ width: `${0}px`, height: `${0}px` });\r\n    const [image, setImage] = useState(null);\r\n    useEffect(\r\n        () => {\r\n            async function getSize() {\r\n                try {\r\n                    let res = await apiImageSize(props.id);\r\n                    setSize(res.data);\r\n                } catch (error) {\r\n                    console.log(error)\r\n                    throw error;\r\n                }\r\n            }\r\n\r\n            async function getImage() {\r\n                try {\r\n                    let res = await apiImage(props.id);\r\n                    let bimage = btob(res.data, res.headers[\"content-type\"]);\r\n                    setImage(\r\n                        <img src={bimage} alt=\"ImageCard\" className=\"image_card_image\"></img>\r\n                    );\r\n                } catch (error) {\r\n                    console.log(error)\r\n                }\r\n            }\r\n            getSize()\r\n                .then(_ => getImage(),\r\n                    _ => setShouldCreate(false))\r\n            return () => {\r\n                setShouldCreate(null);\r\n                setSize(null);\r\n                setImage(null);\r\n            }\r\n        },\r\n        [props.id]\r\n    )\r\n\r\n    return (\r\n        <>\r\n            {shouldCreate &&\r\n                <div style={size} className=\"image_card\">\r\n                    {image}\r\n                </div>\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\nexport default React.memo(ImageCard);","import React, { useEffect, useRef, useState } from 'react';\r\nimport { getLowestIndex } from '../../../Util/SetPropertyHelper';\r\nimport { apiImageSize } from '../../../Api/ImageApi';\r\nimport Glass from '../../../Global/Glassmorphism';\r\nimport './MyGallery.css';\r\nimport ImageCard from '../../../Projects/Project1/ImageCard';\r\nimport { isMobile } from 'react-device-detect';\r\n\r\nfunction MyGallery() {\r\n    // state for resize\r\n    const widthRef = useRef(null);\r\n    const [currentWidth, setCurrentWidth] = useState(0);\r\n\r\n    // state for available Images\r\n    const [allSize, setAllSize] = useState(null);\r\n    const allSizeRef = React.createRef(allSize);\r\n\r\n    // state for currently showed images\r\n    const [renderImage, setRenderImage] = useState([]);\r\n    const renderImageRef = React.createRef(renderImage);\r\n\r\n    let imageCardWidth = 240 + 20;\r\n    let columns = Math.max(Math.floor(currentWidth / imageCardWidth), 1)\r\n\r\n    let margin = 20;\r\n    let initImages = 27;\r\n    let gotAll = false;\r\n\r\n    function renderImageGallery() {\r\n        let imageColumn = [];\r\n        let columnHeight = [];\r\n        for (let i = 0; i < columns; i++) {\r\n            imageColumn.push([]);\r\n            columnHeight.push(0)\r\n        }\r\n        renderImage.forEach((e) => addNewImageCard(e, imageColumn, columnHeight))\r\n\r\n        let imageGallery = [];\r\n        imageColumn.forEach((e, i) =>\r\n            imageGallery.push(<div key={i} className=\"gallery_column\">{e}</div>))\r\n        return imageGallery;\r\n    }\r\n\r\n    function addNewImageCard(id, imageColumn, columnHeight) {\r\n        if (allSize == null)\r\n            return;\r\n        let size = allSize[id];\r\n        if (size == null)\r\n            return;\r\n        let imageHeight = parseInt(size.height.replace(/[^\\d]/g, ''));\r\n        let index = getLowestIndex(columnHeight);\r\n        columnHeight[index] += imageHeight + margin;\r\n        imageColumn[index].push(\r\n            <ImageCard key={id} id={id} style={size}></ImageCard>\r\n        );\r\n    }\r\n\r\n    if (allSize && renderImage && renderImage.length === Object.keys(allSize).length) {\r\n        gotAll = true;\r\n    }\r\n    const imageGallery = renderImageGallery();\r\n\r\n    useEffect(() => {\r\n        function galleryResize() {\r\n            if (!widthRef.current) {\r\n                return;\r\n            }\r\n            let { width, padding } = getComputedStyle(widthRef.current)\r\n            let mWidth = parseInt(width.replace(/[^\\d]/g, '')) -\r\n                parseInt(padding.replace(/[^\\d]/g, '')) * 2;\r\n            setCurrentWidth(mWidth);\r\n        }\r\n\r\n        function reachBotton() {\r\n            let docHeight = document.documentElement.scrollHeight;\r\n            let winHeight = document.documentElement.clientHeight;\r\n            let current = window.scrollY\r\n            if (allSizeRef.current != null && renderImageRef.current != null) {\r\n                let createdImages = renderImageRef.current.length;\r\n                let availableImages = Object.keys(allSizeRef.current).length;\r\n                let m = isMobile ? 3 : 2;\r\n                if (current > (docHeight - m * winHeight)\r\n                    && createdImages < availableImages) {\r\n                    setRenderImage(e => {\r\n                        let n = [...e, e[e.length - 1] + 1];\r\n                        renderImageRef.current = n\r\n                        return n;\r\n                    })\r\n                }\r\n            }\r\n        }\r\n\r\n        async function getAllSize() {\r\n            try {\r\n                let res = await apiImageSize();\r\n                return res.data\r\n            } catch (error) {\r\n                console.log(error)\r\n                throw error;\r\n            }\r\n        }\r\n\r\n        function init() {\r\n            let images = [...Array(initImages + 1).keys()].slice(1);\r\n            renderImageRef.current = images;\r\n            setRenderImage(images)\r\n        }\r\n\r\n        getAllSize()\r\n            .then(p => {\r\n                allSizeRef.current = p;\r\n                setAllSize(p);\r\n            })\r\n        galleryResize();\r\n        init();\r\n        window.addEventListener('scroll', reachBotton, true)\r\n        window.addEventListener('resize', galleryResize, true);\r\n        return () => {\r\n            window.removeEventListener('resize', galleryResize);\r\n            window.removeEventListener('scroll', reachBotton);\r\n            setAllSize(null);\r\n            setCurrentWidth(null);\r\n            setRenderImage(null);\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <>\r\n            <div id='myGallery_description' className='my_d_container s_t_default_bg'>\r\n                <div className='s_c_padding h1_container'>\r\n                    <h1>My Gallery</h1>\r\n                </div>\r\n                <div className='s_c_padding h2_container'>\r\n                    <h2>This project is trying to fetch Images dynamically from ExpressJs Backend, through RESTful API.\r\n                        <br /><br />Waiting list of items to be integrated in this project:\r\n                        <br /><br />Progressive Image Loading, Image Upload Function,\r\n                        <br />Integrate and Upgrade Search Engine developed in my University Project to this Project, etc.\r\n                    </h2>\r\n                </div>\r\n            </div>\r\n            <div id=\"myGallery_container\" className=\"content_container\">\r\n                <div id=\"gallery_container\" className=\"s_c_padding\" >\r\n                    <Glass id=\"gallery\" glassColor=\"white\" ref={widthRef}>\r\n                        {imageGallery}\r\n                    </Glass>\r\n                </div>\r\n            </div>\r\n            {\r\n                gotAll &&\r\n                (<div className='my_d_footer'>\r\n                    <div className=\"s_c_padding h2_container \">\r\n                        <h2>That's all we can get from the server~</h2>\r\n                    </div>\r\n                </div>)\r\n            }\r\n        </>\r\n    )\r\n}\r\nexport default MyGallery;"],"sourceRoot":""}